# spring-gift-product

#### 위시리스트 기능 추가

- 사용자별 위시리스트 상품 추가, 조회, 삭제(CRD) 기능 구현
- 위시리스트 전체 기능에 대한 테스트 코드 작성
- 커스텀 예외: `UnAuthenticatedException`, `ResourceNotFoundException` 추가
- 토큰 만료, 토큰 유효성 오류, 리소스 미존재 시 대응하는 `ErrorCode` 추가

#### 회원 인증(로그인/등록) 응답 코드 정책

- 회원 등록 실패 시: **400 Bad Request**
- 잘못된 로그인, 비밀번호 찾기, 비밀번호 변경 요청 시: **403 Forbidden**
- 정상적으로 회원 등록/로그인 시: **200 OK** + JWT 토큰 반환

#### 유효성 검사 및 예외 처리

- 상품 등록/수정 API에도 예외 핸들러를 적용하여 유효성 검사 실패 시 일관된 에러 응답을 제공합니다.
- 상품 웹페이지에서 등록/수정 시 유효성 검사를 적용하고, 실패 시에도 일관된 에러 메시지와 사용자 경험을 제공합니다.
- 상품 CRUD 전체 흐름에 대한 통합 테스트를 작성하여, 유효성 검사 및 예외 처리 로직이 실제 요청에서도 올바르게 동작하는지 검증했습니다.
- 존재하지 않는 상품 삭제 시 400이 아닌 404 상태 코드를 반환하도록 수정하여, HTTP 명세에 맞는 예외 응답을 제공합니다.
- 테스트 코드에서 반복적으로 생성되던 requestDto 객체 생성을 제거하여, 코드 간결성과 테스트 성능을 개선했습니다.

**유효성 검사 상세 기준**

1. **상품 이름(name)**
   - 공백 입력 시: “상품 이름은 필수입니다.”
   - 15자 초과 입력 시: “상품 이름은 공백 포함 최대 15자까지 입력할 수 있습니다.”
   - 허용되지 않는 특수문자 사용 시 (허용: `( )`, `[ ]`, `+`, `-`, `&`, `/`, `_`):  
     “허용되지 않는 특수문자가 포함되어 있습니다.”
   - “카카오” 단어가 포함된 경우: “‘카카오’가 포함된 문구는 담당 MD와 협의한 경우에만 사용할 수 있습니다.”

2. **상품 가격(price)**
   - 0 미만 입력 시: “상품 가격은 0 이상 값을 가져야 합니다.”

3. **이미지 URL(imageUrl)**
   - 공백 입력 시: “이미지 URL은 필수입니다.”

#### 관리자 화면 구현

| 구현 기능            |
|------------------|
| 물품 등록            |
| 물품 수정            |
| 같은 열에 존재하는 물품 삭제 |
| 선택한 물품들 모두 삭제    |

#### H2 DB 적용 및 Repository 구조 리팩토링

- **Feat: H2 DB 설정 및 초기 데이터 스크립트 적용**
    - H2 in-memory DB 도입 및 application.properties 설정
    - `schema.sql`, `data.sql`을 통해 product 테이블 구조와 초기 데이터 삽입
    - `spring.sql.init.mode=always` 등 SQL 스크립트 자동 실행 설정

- **Refactor: 임시 Map 저장소를 H2 DB 연동 방식으로 리팩토링**
    - 기존의 `Map<Long, Product>` 형태의 임시 저장소 제거
    - `JdbcTemplate` 기반의 실제 DB 연동 Repository 구현
    - DB 기반 저장/조회/수정/삭제 기능으로 대체

- **Refactor: Repository의 DTO 반환 책임을 제거하여 SRP 준수**
    - Repository에서 `ProductResponseDto` 반환 제거
    - DB에서 도메인 객체(`Product`)만 반환하도록 수정
    - DTO 변환은 Service 계층에서 처리하도록 역할 분리

#### API 명세서

- 상품 API

| URL | Method | 기능 | 설명                   |
|--------------|--------|-----------|----------------------|
| /api/products | POST   |  물품 등록 | 새 물품을 등록한다.          |
| /api/products/{id} | GET    | 물품 단건 조회 | id 값으로 물품 하나를 조회한다.  |
| /api/products | GET    |  물품 목록 조회 | 모든 물품을 조회한다. |
| /api/products/{id} | PUT    | 물품 수정 | id 값에 매핑된 물품 하나를 수정한다. |
| /api/products/{id} | DELETE | 물품 삭제 | id 값에 매핑된 물품 하나를 삭제한다. |


#### 커밋 컨벤션


| type | meaning            |
| ----- |--------------------|
| feat | 기능 추가              |
| fix | 버그 수정              |
| docs | 문서 변경 (주석, README) |
| style | format 변경          |
| refactor | 리팩토링               |
| test | 테스트 코드 추가/수정       |
| chore | 유지보수 작업            |