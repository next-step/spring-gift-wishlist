# 카카오 선물하기 클론 코딩 프로젝트

## 1. 상품 관리

### 1단계. 상품 API 기능 구현 (완료)

- [X] 상품 단건 조회: 특정 상품의 정보를 조회하는 기능
    - GET /api/products/{productId}
    - **세부사항**: 상품이 존재하지 않을 경우 '404 Not Found' 응답
- [X] 상품 목록 조회: 모든 상품의 목록을 페이지 단위로 조회하는 기능
    - GET /api/products?page=0&size=10&sort=name,asc&categoryId=1
    - **세부사항**:
        - 'page': 페이지 번호 (기본값 0으로 설정)
        - 'size': 페이지당 상품 수 (기본값 10으로 설정)
        - 'sort': 정렬 기준 (예시: 'name, asc' / 'price, desc')
        - 'categoryId': 특정 카테고리로 필터링 (현재 구현 범위에서는 미포함, 이후 미션에서 수행할 예정)
- [X] 상품 등록: 새 상품을 등록한다.
    - POST /api/products
    - **세부사항**:
        - 요청 및 응답은 JSON 형식
        - 성공 시 '201 Created' 응답 및 'Location' 헤더에 생성된 리소스 URI 포함
        - 유효성 검사(이름 공백, 음수 가격) 실패 시 '400 Bad Request' 응답.
        - 이미 존재하는 ID로 등록 시도 시 '409 Conflict' 응답
- [X] 상품 삭제: 특정 상품을 삭제한다.
    - DELETE /api/products/{productId}
    - **세부사항**:
        - 성공 시 '204 No Content' 응답
        - 상품이 존재하지 않을 경우 '404 Not Found' 응답
- [X] 상품 수정: 특정 상품의 정보를 수정한다.
    - PUT /api/products/{productId}
    - **세부사항**:
        - 요청 및 응답은 JSON 형식
        - 성공 시 '200 OK' 응답
        - 유효성 검사 실패 시 '400 Bad Request' 응답
        - 상품이 존재하지 않을 경우 '404 Not Found' 응답

### 프로그래밍 요구사항 (1단계)

* **데이터 저장:** 현재는 별도의 데이터베이스 없이 Map을 사용하여 메모리에 상품 데이터를 저장한다. 즉, 애플리케이션 재시작 시 데이터는 초기화된다.

### 2단계. 상품 관리자 화면 구현 (완료)

* [X] **상품 목록 관리 페이지**:
    * 모든 상품의 목록을 테이블 형태로 표시한다.
    * 각 상품의 상세 정보 조회, 수정, 삭제 링크 또는 버튼을 제공한다.
    * 새 상품 등록 페이지로 이동하는 버튼을 제공한다.
* [X] **상품 상세 조회 페이지**:
    * 특정 상품의 모든 정보를 표시한다.
    * 목록 페이지로 돌아가기, 수정 페이지로 이동하기, 삭제하기 버튼을 제공한다.
* [X] **상품 등록 폼 페이지**:
    * 새 상품 정보를 입력할 수 있는 폼을 제공한다.
    * 등록 성공 시 상품 목록 페이지로 이동한다.
    * 유효성 검사 실패 시 에러 메시지와 함께 폼을 다시 표시한다.
* [X] **상품 수정 폼 페이지**:
    * 기존 상품 정보를 미리 채워 넣은 폼을 제공한다.
    * 수정 성공 시 상품 상세 페이지 또는 목록 페이지로 이동한다.
    * 유효성 검사 실패 시 에러 메시지와 함께 폼을 다시 표시한다.
* [X] **상품 삭제 기능**:
    * 상품 목록/상세 페이지에서 삭제 버튼을 통해 상품을 삭제한다.
    * 삭제 성공 시 상품 목록 페이지로 이동한다.

### 프로그래밍 요구사항 (2단계)

* **서버 사이드 렌더링 (SSR)**: Thymeleaf 템플릿 엔진을 사용하여 웹 페이지를 동적으로 생성한다.
* **이미지 처리**: 상품 이미지 파일을 직접 업로드하지 않고, 이미지 URL을 텍스트 필드로 입력받는다.
* **기본 HTML 폼 전송**: 페이지 이동을 기반으로 한 폼 전송 방식을 사용한다.

---

### 3단계. 데이터베이스 적용 (완료)

- [X] **H2 데이터베이스 테이블 스키마 설정**: 애플리케이션 실행 시 상품 테이블(`products`)이 생성되도록 `schema.sql` 파일 작성
- [X] **상품 목록 및 단건 조회 DB 연동**: `findAll`, `findById` 메서드를 `JdbcTemplate`을 사용하도록 수정
- [X] **상품 등록 DB 연동**: `save` 메서드를 `JdbcTemplate` 또는 `SimpleJdbcInsert`를 사용하도록 수정하고, DB에서 자동 생성된 ID를
  반환받도록 변경
- [X] **상품 수정 및 삭제 DB 연동**: `update`, `delete` 메서드를 `JdbcTemplate`을 사용하도록 수정
- [X] **상품 ID 관리 로직 수정**: DB의 `AUTO_INCREMENT` 기능을 사용함에 따라 서비스 및 DTO에서 ID를 직접 다루던 로직 제거

---
## 2. 상품 위시리스트

### 0단계. 기본 코드 준비 (완료)
- [X] 이전 단계의 상품 관리 코드를 옮겨 온다.

### 1단계. 유효성 검사 및 예외처리 (완료)
- [X] **커스텀 유효성 검사기 구현**:
    - 상품 이름에 대한 커스텀 유효성 검사 어노테이션(`@ValidProductName`) 및 검사기(`ProductNameValidator`)를 구현함.
    - 검사 규칙: 이름은 공백 포함 최대 15자, 허용된 특수 문자 외 사용 불가, "카카오" 문구 포함 불가.
- [X] **DTO에 커스텀 유효성 검사 적용**:
    - `ItemRequest` DTO의 `name` 필드에 `@ValidProductName` 어노테이션을 적용함.
- [X] **Repository 테스트 코드 작성**:
    - `ItemRepository`의 모든 CRUD(생성, 조회, 수정, 삭제) 동작을 검증하는 단위 테스트를 작성함. (`@DataJdbcTest` 활용)
- [X] **Controller 테스트 코드 작성**:
    - `AdminItemController`와 `ItemController`의 핵심 API 기능(성공 및 유효성 검사 실패 케이스)을 검증하는 통합 테스트를 작성함. (`@SpringBootTest`, `MockMvc` 활용)
- [X] **전역 예외 처리 리팩토링**:
    - 컨트롤러의 `try-catch` 구문을 제거하고 `@ControllerAdvice`를 도입하여 예외 처리를 중앙에서 관리하도록 개선함.
    - API 요청과 웹 페이지 요청에 따라 다른 형태의 에러 응답을 반환하도록 예외 처리기를 분리하고, `@Order`로 우선순위를 제어함.

### 2단계. 회원 로그인 및 인증 구현
### 5단계. 회원 로그인 및 인증 구현

- [ ] **회원(Member) 도메인 생성**:
    - `Member` 엔티티, `Role` 열거형(Enum), `MemberRepository`를 작성한다.
    - `schema.sql`에 `members` 테이블 생성 DDL을 추가한다.
- [ ] **Repository 테스트 작성**:
    - `MemberRepository`가 DB와 올바르게 통신하는지 검증하는 통합 테스트를 작성한다.
- [ ] **JWT(JSON Web Token) 유틸리티 구현**:
    - JJWT 라이브러리를 사용하여 토큰을 생성하고, 유효성을 검증하는 `JwtUtil` 클래스를 작성한다.
    - 해당 로직을 검증하는 단위 테스트를 작성한다.
- [ ] **회원가입 및 로그인 서비스 로직 구현**:
    - `MemberService`에 회원가입(`register`)과 로그인(`login`) 비즈니스 로직을 구현한다.
    - 로그인 성공 시 JWT를 발급하도록 `JwtUtil`과 연동한다.
- [ ] **API 엔드포인트 구현**:
    - `MemberController`에 `/api/members/register`와 `/api/members/login` 엔드포인트를 구현한다.
- [ ] **인증 인터셉터(Authentication Interceptor) 구현**:
    - `HandlerInterceptor`를 사용하여 특정 요청에 대해 JWT 토큰의 유효성을 검사하는 인증 로직을 구현한다.
    - `WebMvcConfigurer`를 통해 어떤 URL에 인터셉터를 적용할지 설정한다.
- [ ] **상품명 '카카오' 금지 규칙 수정**:
    - 기존의 '카카오' 단어 금지 유효성 검사를 제거한다.
    - 상품 등록/수정 서비스 로직에서, **ADMIN 권한을 가진 사용자일 경우에만 '카카오' 포함 상품명을 허용**하도록 수정한다.
- [ ] **인증 적용 API 테스트**:
    - 인증이 필요한 API(예: 상품 등록)를 토큰 없이 호출했을 때 401 에러가 발생하는지, 유효한 토큰으로 호출했을 때 성공하는지 검증하는 통합 테스트를 작성한다.